var xhrPool=[];if(!String.repeat){String.prototype.repeat=function(e){return(new Array(e+1)).join(this)}}(function(e){var t={init:function(){e("body").fitVids();t.xhrPool;t.onbeforeunloadAbort();t.placeHolder();t.loopViewSwitcher();t.lessMore();t.masonry();e("#main-nav .menu").deSelectMenu({});e(".orderby-select").change(function(){location.href=this.options[this.selectedIndex].value})},xhrPool:function(){e(document).ajaxSend(function(e,t,n){xhrPool.push(t)});e(document).ajaxComplete(function(t,n,r){xhrPool=e.grep(xhrPool,function(e){return e!=n})})},ajaxVideo:function(n){var r=e(n);pid=r.attr("data-id"),thumb=r.parents(".thumb"),caption=r.parents(".item").find(".caption"),list=r.parents(".carousel-list");if(r.data("clickable")=="no")return false;list.find(".video").remove();list.find(".caption").show();list.find(".thumb").show().removeClass("loading");caption.hide();thumb.addClass("loading");var i=e.ajax({url:theme_ajaxurl,type:"POST",data:{action:"ajax-video",id:pid},dataType:"html",beforeSend:function(e){t.abortAll();list.find(".thumb a").data("clickable","");r.data("clickable","no")}}).fail(function(e,t,n){if(n!=="abort"){alert(ajaxerror);thumb.removeClass("loading")}}).done(function(t,n,r){thumb.before('<div class="video fluid-width-video-wrapper"></div>');var i=thumb.prev(".video");i.hide().html(t);if(i.find("iframe").length){i.find("iframe").load(function(){i.show();thumb.hide().removeClass("loading")})}else{i.show();thumb.hide().removeClass("loading")}e("body").fitVids()}).always(function(e,t){r.data("clickable","")})},connectedControl:function(t,n){if(jQuery().jcarousel===undefined)return;n.jcarousel("items").each(function(){var r=e(this),i=t.jcarousel("items").eq(r.index());r.on("click",function(){if(t.data("jcarouselautoscroll")=="stopped"){t.jcarouselAutoscroll("start");t.data("jcarouselautoscroll",true)}}).on("active.jcarouselcontrol",function(){n.jcarousel("scrollIntoView",this);r.addClass("active")}).on("inactive.jcarouselcontrol",function(){r.removeClass("active")}).jcarouselControl({target:i,carousel:t})})},clickAjax:function(n,r,i){if(!r.data("ajaxload"))return false;e(n).on("click",function(e){e.preventDefault();if(i.data("jcarouselautoscroll"))i.jcarouselAutoscroll("stop").data("jcarouselautoscroll","stopped");t.ajaxVideo(this);return false})},abortAll:function(){e.each(xhrPool,function(e,t){t.abort()})},stageSetup:function(t){t.find(".item-video").each(function(){if(e(this).find(".video").length)e(this).find(".thumb, .caption").hide()})},autoScroll:function(e){var t=e.data("autoscroll-interval");if(t>0){e.jcarouselAutoscroll({interval:t,autostart:true})}},targetedStage:function(t){t.on("itemtargetin.jcarousel",".item",function(t,n){var r=e(this);r.find(".thumb").show();r.find(".caption").show();r.siblings(".item").find(".video").remove();r.parents(".wall").find(".entry-header").hide();r.parents(".wall").find('.entry-header[data-id="'+r.data("id")+'"]').fadeIn()}).on("itemtargetout.jcarousel",".item",function(t,n){var r=e(this)})},prevNextControl:function(t){e(".prev-stage").on("inactive.jcarouselcontrol",function(){e(this).addClass("inactive")}).on("active.jcarouselcontrol",function(){e(this).removeClass("inactive")}).jcarouselControl({target:"-=1",carousel:t});e(".next-stage").on("inactive.jcarouselcontrol",function(){e(this).addClass("inactive")}).on("active.jcarouselcontrol",function(){e(this).removeClass("inactive")}).jcarouselControl({target:"+=1",carousel:t})},lessMore:function(){var t=e("#info").data("less-height");trueHeight=e("#info").outerHeight(false);if(trueHeight>t){e(".info-toggle-arrow").css("display","inline-block");e(".info-toggle").show();e("#info").height(t)}e(".info-toggle-button, .info-toggle-arrow").click(function(){e("#info").toggleClass("info-more");e(".info-toggle-button").toggleClass("info-more-button");e(".info-toggle-arrow").toggleClass("info-more-arrow");return false})},loopViewSwitcher:function(){e(".loop-actions .view a").on("click",function(t){t.preventDefault();var n=e(this).attr("data-type"),r=e(".switchable-view"),i=r.attr("data-view");if(n==i)return false;e(this).addClass("current").siblings("a").removeClass("current");r.stop().fadeOut(100,function(){if(i)r.removeClass(i);e(this).fadeIn().attr("data-view",n).addClass(n)});e(".loop-content .video").remove();e(".loop-content .thumb").show();e.cookie("loop_view",n,{path:"/",expires:999});return false})},placeHolder:function(){e('input[type="text"]').each(function(){var t=e(this).attr("placeholder");e(this).on("focus",function(){if(e(this).attr("value")=="")e(this).attr("value","").attr("placeholder","")}).on("blur",function(){if(e(this).attr("value")=="")e(this).attr("placeholder",t)})})},onbeforeunloadAbort:function(){var e=window.onbeforeunload;window.onbeforeunload=function(){var n=e?e():undefined;if(n==undefined){t.abortAll()}return n}},masonry:function(){if(!e.isFunction(e.fn.masonry))return false;var t=e("#sidebar");if(t.hasClass("masonry")){var n=function(){t.imagesLoaded(function(){t.masonry({itemSelector:".widget",columnWidth:300,gutterWidth:20,isRTL:e("body").is(".rtl")})})};if(t.find("iframe").length){t.find("iframe").load(function(){n()})}else{n()}}var r=e("#footbar-inner");if(r.hasClass("masonry")){var i=function(){r.imagesLoaded(function(){var t=e("#footbar").data("layout")=="c4s1"?".widget-col":".widget";r.masonry({itemSelector:t,columnWidth:60,gutterWidth:20,isRTL:e("body").is(".rtl")})})};if(r.find("iframe").length){r.find("iframe").load(function(){i()})}else{i()}}}};e(document).ready(function(){t.init()});e(window).on("load resize",function(){e(".fcarousel-5").deCarousel();e(".fcarousel-6").deCarousel()});e(function(){if(e(".loop-content").data("ajaxload")){e(".item-video .thumb a").on("click",function(n){if(e(this).parents(".list-large").length){n.preventDefault();e(".list-large .video").remove();e(".list-large .thumb").show().removeClass("loading");t.ajaxVideo(this);return false}})}});e(function(){var n=e(".home-featured-full .stage"),r=n.find(".carousel");t.stageSetup(n);if(jQuery().jcarousel){r.jcarousel({wrap:"circular"});t.autoScroll(r);t.targetedStage(r);var i=e(".fcarousel-6").deCarousel();t.connectedControl(r,i);t.clickAjax(".home-featured-full .stage .item-video .thumb a",n,r)}});e(function(){var n=e(".home-featured .stage");var r=n.find(".carousel");t.stageSetup(n);if(jQuery().jcarousel){r.jcarousel({wrap:"circular"});t.autoScroll(r);t.targetedStage(r);var i=e(".home-featured .nav .carousel-clip").jcarousel({vertical:true,wrap:"circular"});e(".home-featured .carousel-prev").jcarouselControl({target:"-=4"});e(".home-featured .carousel-next").jcarouselControl({target:"+=4"});t.connectedControl(r,i)}t.clickAjax(".home-featured .stage .item-video .thumb a",n,r)})})(jQuery)
(function ($) {
	// add mime-type aliases to MediaElement plugin support
	mejs.plugins.silverlight[0].types.push('video/x-ms-wmv');
	mejs.plugins.silverlight[0].types.push('audio/x-ms-wma');

	$(function () {
		var settings = {};

		if ( typeof _wpmejsSettings !== 'undefined' )
			settings.pluginPath = _wpmejsSettings.pluginPath;

		$('.wp-audio-shortcode, .wp-video-shortcode').mediaelementplayer( settings );
	});

}(jQuery));